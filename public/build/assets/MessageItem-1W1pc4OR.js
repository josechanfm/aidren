import{r as b,T as y,d as s,a as e,t as i,e as r,y as f,B as p,J as x,u as h,F,g as R,o,K as j}from"./app-Cta_gWxB.js";const M={class:"bg-white shadow-sm rounded-lg p-4 mb-4"},P={class:"flex justify-between items-start"},V={class:"font-semibold text-lg"},I={class:"text-gray-500 text-sm"},N={key:0,class:"space-x-2"},T={key:0,class:"mt-2"},U={class:"mt-2 flex justify-end"},q=["disabled"],A={key:3,class:"mt-4 space-y-4"},J={class:"flex justify-between items-start"},K={class:"font-semibold"},L={class:"text-gray-500 text-sm"},O={key:0,class:"text-sm text-gray-500"},W={class:"mt-2"},G={__name:"MessageItem",props:{message:Object,canEdit:Boolean,canDelete:Boolean,topicId:Number},emits:["reply-added"],setup(t,{emit:k}){const l=t,w=k,u=b(!1),c=b(!1),d=b(""),v=b(!1),m=y({content:l.message.content});y({content:"",isPrivate:!1});const _=()=>{u.value=!0},E=()=>{u.value=!1,m.reset()},C=()=>{m.put(route("member.forum.messages.update",l.message.id),{preserveScroll:!0,onSuccess:()=>{u.value=!1}})},B=()=>{confirm("Are you sure you want to delete this message?")&&y().delete(route("member.forum.messages.destroy",l.message.id))},D=()=>{c.value=!c.value},S=()=>{v.value=!0,console.log(d.value),j.post(route("member.topic.messages.store",{topic:l.topicId}),{content:d.value,parent_id:l.message.id}).then(g=>{w("reply-added",g.data,l.message.id),c.value=!1,d.value=""}).catch(g=>{console.error("Error posting reply:",g)}).finally(()=>{v.value=!1})};return(g,n)=>(o(),s("div",M,[e("div",P,[e("div",null,[e("h3",V,i(t.message.user.name),1),e("p",I,i(t.message.created_at),1)]),t.canEdit||t.canDelete?(o(),s("div",N,[t.canEdit?(o(),s("button",{key:0,onClick:_,class:"text-blue-600 hover:text-blue-800"},"Edit")):r("",!0),t.canDelete?(o(),s("button",{key:1,onClick:B,class:"text-red-600 hover:text-red-800"},"Delete")):r("",!0)])):r("",!0)]),u.value?(o(),s("form",{key:1,onSubmit:f(C,["prevent"]),class:"mt-2"},[p(e("textarea",{"onUpdate:modelValue":n[0]||(n[0]=a=>h(m).content=a),class:"w-full p-2 border rounded",rows:"3"},null,512),[[x,h(m).content]]),e("div",{class:"mt-2 space-x-2"},[n[2]||(n[2]=e("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"},"Save",-1)),e("button",{onClick:E,class:"bg-gray-300 text-gray-800 px-4 py-2 rounded hover:bg-gray-400"},"Cancel")])],32)):(o(),s("div",T,[e("p",null,i(t.message.content),1)])),e("div",{class:"mt-4"},[e("button",{onClick:D,class:"text-blue-600 hover:text-blue-800"},"Reply")]),c.value?(o(),s("form",{key:2,onSubmit:f(S,["prevent"]),class:"mt-4"},[p(e("textarea",{"onUpdate:modelValue":n[1]||(n[1]=a=>d.value=a),rows:"3",class:"w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none",placeholder:"Write your reply here...",required:""},null,512),[[x,d.value]]),e("div",U,[e("button",{type:"submit",class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:v.value}," Post Reply ",8,q)])],32)):r("",!0),t.message.replies&&t.message.replies.length>0?(o(),s("div",A,[(o(!0),s(F,null,R(t.message.replies,a=>(o(),s("div",{key:a.id,class:"ml-8 bg-gray-50 p-3 rounded"},[e("div",J,[e("div",null,[e("h4",K,i(a.user.name),1),e("p",L,i(a.created_at),1)]),a.isPrivate?(o(),s("div",O,"Private")):r("",!0)]),e("p",W,i(a.content),1)]))),128))])):r("",!0)]))}};export{G as default};
