import{_ as G}from"./AppLayout-mOvPgsmj.js";import{b as u,I as Y,i as M,j as W,k as J,r as Q,l as X,m as Z,p as $,q as ee,s as j,v as I,D as te,x,h as f,c as U,w as c,o as h,a as p,t as B,d as E,f as A,F as V,g as N}from"./app-QC31J3KV.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";var ae={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};function q(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),r.forEach(function(a){oe(e,a,n[a])})}return e}function oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var F=function(t,n){var r=q({},t,n.attrs);return u(Y,q({},r,{icon:ae}),null)};F.displayName="UploadOutlined";F.inheritAttrs=!1;var ie=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCommentChange","onCompositionEnd","onCompositionStart","onCompositionUpdate","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onInput","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],re=function(e){return ie.map(function(t){return t.toLowerCase()}).indexOf(e.toLowerCase())!==-1},le=function(e,t,n){Object.keys(t).filter(re).forEach(function(r){var a=t[r];typeof a=="function"&&(r==="onInit"?a(e,n):n.on(r.substring(2),function(i){return a(i,n)}))})},ue=function(e,t,n,r){var a=e.modelEvents?e.modelEvents:null,i=Array.isArray(a)?a.join(" "):a;M(r,function(m,s){n&&typeof m=="string"&&m!==s&&m!==n.getContent({format:e.outputFormat})&&n.setContent(m)}),n.on(i||"change input undo redo",function(){t.emit("update:modelValue",n.getContent({format:e.outputFormat}))})},se=function(e,t,n,r,a,i){r.setContent(i()),n.attrs["onUpdate:modelValue"]&&ue(t,n,r,a),le(e,n.attrs,r)},R=0,K=function(e){var t=Date.now(),n=Math.floor(Math.random()*1e9);return R++,e+"_"+n+R+String(t)},ce=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},T=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},de=function(e,t){return T(e).concat(T(t))},me=function(e){return e==null},z=function(){return{listeners:[],scriptId:K("tiny-script"),scriptLoaded:!1}},fe=function(){var e=z(),t=function(a,i,m,s){var l=i.createElement("script");l.referrerPolicy="origin",l.type="application/javascript",l.id=a,l.src=m;var g=function(){l.removeEventListener("load",g),s()};l.addEventListener("load",g),i.head&&i.head.appendChild(l)},n=function(a,i,m){e.scriptLoaded?m():(e.listeners.push(m),a.getElementById(e.scriptId)||t(e.scriptId,a,i,function(){e.listeners.forEach(function(s){return s()}),e.scriptLoaded=!0}))},r=function(){e=z()};return{load:n,reinitialize:r}},ve=fe(),he=function(){return typeof window<"u"?window:global},b=function(){var e=he();return e&&e.tinymce?e.tinymce:null},pe={apiKey:String,licenseKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},v=function(){return v=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},v.apply(this,arguments)},ge=function(e,t,n,r){return e(r||"div",{id:t,ref:n})},ye=function(e,t,n){return e("textarea",{id:t,visibility:"hidden",ref:n})},k={selector:void 0,target:void 0},_e=W({props:pe,setup:function(e,t){var n=e.init?v(v({},e.init),k):v({},k),r=J(e),a=r.disabled,i=r.modelValue,m=r.tagName,s=Q(null),l=null,g=e.id||K("tiny-vue"),O=e.init&&e.init.inline||e.inline,L=!!t.attrs["onUpdate:modelValue"],C=!0,S=e.initialValue?e.initialValue:"",y="",D=function(d){return L?function(){return i!=null&&i.value?i.value:""}:function(){return d?S:y}},_=function(){var d=D(C),o=v(v({},n),{readonly:e.disabled,target:s.value,plugins:de(n.plugins,e.plugins),toolbar:e.toolbar||n.toolbar,inline:O,setup:function(w){l=w,w.on("init",function(H){return se(H,e,t,w,i,d)}),typeof n.setup=="function"&&n.setup(w)}});ce(s.value)&&(s.value.style.visibility=""),b().init(o),C=!1};M(a,function(d){var o;l!==null&&(typeof((o=l.mode)===null||o===void 0?void 0:o.set)=="function"?l.mode.set(d?"readonly":"design"):l.setMode(d?"readonly":"design"))}),M(m,function(d){var o;L||(y=l.getContent()),(o=b())===null||o===void 0||o.remove(l),I(function(){return _()})}),X(function(){if(b()!==null)_();else if(s.value&&s.value.ownerDocument){var d=e.cloudChannel?e.cloudChannel:"7",o=e.apiKey?e.apiKey:"no-api-key",w=me(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(o,"/tinymce/").concat(d,"/tinymce.min.js"):e.tinymceScriptSrc;ve.load(s.value.ownerDocument,w,_)}}),Z(function(){b()!==null&&b().remove(l)}),O||($(function(){C||_()}),ee(function(){var d;L||(y=l.getContent()),(d=b())===null||d===void 0||d.remove(l)}));var P=function(d){var o;y=l.getContent(),(o=b())===null||o===void 0||o.remove(l),n=v(v(v({},n),d),k),I(function(){return _()})};return t.expose({rerender:P,getEditor:function(){return l}}),function(){return O?ge(j,g,s,e.tagName):ye(j,g,s)}}});const be={components:{AppLayout:G,Editor:_e,UploadOutlined:F,DeleteOutlined:te},props:{categories:Object,article:{type:Object,default:()=>({})}},data(){return{dateFormat:"YYYY-MM-DD",uploaded_thumbnail:null,uploaded_attachments:null,thumbnailList:[],attachmentsList:[],tinymceApiKey:"5739310muqbso2y7maj1i0e8cdim6wkmn16235vb6oe86wk9",editorInit:{height:300,menubar:!1,plugins:["link","lists","autolink","table","code"],toolbar:"undo redo | formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist | link table code",branding:!1,readonly:!1}}},mounted(){var e,t;this.uploaded_thumbnail=(e=this.article.media)==null?void 0:e.find(n=>n.collection_name==="thumbnail"),this.uploaded_attachments=(t=this.article.media)==null?void 0:t.filter(n=>n.collection_name==="attachments"),this.article.attachments=[],this.article.attachments=[]},computed:{isEditMode(){return!!this.article.id}},methods:{customThumbnailRequest({file:e,onSuccess:t}){this.article.thumbnail=e,this.thumbnailList=[e],t()},customAttachmentsRequest({file:e,onSuccess:t}){return this.article.attachments.push(e),new Promise((n,r)=>{const a=new FileReader;a.onload=i=>{const m={uid:e.uid,name:e.name,status:"done",url:i.target.result,file:e};this.attachmentsList=[...this.attachmentsList,m],t(),n(!0)},a.onerror=i=>{console.error("Error reading file:",i),onError(i),r(i)},a.readAsDataURL(e)})},submit(){console.log(this.attachmentsList),this.isEditMode?(this.article._method="PATCH",this.$inertia.post(route("admin.articles.update",this.article.id),this.article,{preserveScroll:!0,forceFormData:!0,onSuccess:()=>x.success("News updated successfully"),onError:e=>{console.error("Validation errors:",e),x.error("Failed to update article. Please check the form and try again.")}})):(console.log(this.article),this.$inertia.post(route("admin.articles.store"),this.article,{preserveScroll:!0,forceFormData:!0,onSuccess:()=>x.success("News created successfully"),onError:e=>{console.error("Validation errors:",e),x.error("Failed to create article. Please check the form and try again.")}}))}}},Ce={class:"font-semibold text-xl text-gray-800 leading-tight"},Se={class:"py-12"},we={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Ee={key:0,class:"flex items-end"},Oe=["src"],Le=["src"],xe=["src"];function Ae(e,t,n,r,a,i){const m=f("a-select"),s=f("a-form-item"),l=f("a-input"),g=f("Editor"),O=f("a-date-picker"),L=f("DeleteOutlined"),C=f("upload-outlined"),S=f("a-button"),y=f("a-upload"),D=f("a-space"),_=f("a-form"),P=f("a-card"),d=f("AppLayout");return h(),U(d,null,{header:c(()=>[p("h2",Ce,B(i.isEditMode?"Edit News":"Create News"),1)]),default:c(()=>[p("div",Se,[p("div",we,[u(P,{class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},{default:c(()=>[u(_,{model:n.article,onFinish:i.submit,"label-col":{style:{width:"200px"}},"wrapper-col":{style:{width:"calc(100% - 200px)"}},enctype:"multipart/form-data"},{default:c(()=>[u(s,{label:"Category",name:"category",rules:[{required:!0,message:"Please input the category!"}]},{default:c(()=>[u(m,{value:n.article.category,"onUpdate:value":t[0]||(t[0]=o=>n.article.category=o),options:n.categories},null,8,["value","options"])]),_:1}),u(s,{label:"Title",name:"title",rules:[{required:!0,message:"Please input the title!"}]},{default:c(()=>[u(l,{type:"input",value:n.article.title,"onUpdate:value":t[1]||(t[1]=o=>n.article.title=o)},null,8,["value"])]),_:1}),u(s,{label:"Content",name:"content",rules:[{required:!0,message:"Please input the content!"}]},{default:c(()=>[u(g,{"api-key":a.tinymceApiKey,init:a.editorInit,modelValue:n.article.content,"onUpdate:modelValue":t[2]||(t[2]=o=>n.article.content=o)},null,8,["api-key","init","modelValue"])]),_:1}),u(s,{label:"Author",name:"author"},{default:c(()=>[u(l,{type:"input",value:n.article.author,"onUpdate:value":t[3]||(t[3]=o=>n.article.author=o)},null,8,["value"])]),_:1}),u(s,{label:"Publish Date",name:"published_at"},{default:c(()=>[u(O,{value:n.article.published_at,"onUpdate:value":t[4]||(t[4]=o=>n.article.published_at=o),"show-time":"",format:a.dateFormat,valueFormat:a.dateFormat},null,8,["value","format","valueFormat"])]),_:1}),u(s,{label:"Thumbnail",name:"thumbnail"},{default:c(()=>[a.uploaded_thumbnail?(h(),E("div",Ee,[p("img",{src:a.uploaded_thumbnail.original_url,width:"200",class:"mr-2"},null,8,Oe),p("a",{class:"text-red-500",onClick:t[5]||(t[5]=o=>a.uploaded_thumbnail=null)},[u(L)])])):(h(),U(y,{key:1,"file-list":a.thumbnailList,"onUpdate:fileList":t[6]||(t[6]=o=>a.thumbnailList=o),"custom-request":i.customThumbnailRequest,"list-type":"picture","max-count":1},{default:c(()=>[u(S,null,{default:c(()=>[u(C),t[8]||(t[8]=A(" Select Thumbnail "))]),_:1})]),_:1},8,["file-list","custom-request"]))]),_:1}),u(s,{label:"Attachments",name:"attachments"},{default:c(()=>[a.uploaded_attachments&&a.uploaded_attachments.length>0?(h(),E(V,{key:0},[p("ol",null,[(h(!0),E(V,null,N(a.uploaded_attachments,o=>(h(),E("li",{key:o.id},[p("img",{src:o.original_url,width:"200"},null,8,Le)]))),128))]),p("ul",null,[(h(!0),E(V,null,N(n.article.attachments,o=>(h(),E("li",{key:o.id},[p("img",{src:o.original_url,width:"200"},null,8,xe)]))),128))])],64)):(h(),U(y,{key:1,"file-list":a.attachmentsList,"onUpdate:fileList":t[7]||(t[7]=o=>a.attachmentsList=o),"custom-request":i.customAttachmentsRequest,multiple:!0,"max-count":5},{default:c(()=>[u(S,null,{default:c(()=>[u(C),t[9]||(t[9]=A(" Select Attachments (Max 5) "))]),_:1})]),_:1},8,["file-list","custom-request"]))]),_:1}),u(s,{"wrapper-col":{offset:6,span:18}},{default:c(()=>[u(D,null,{default:c(()=>[u(S,{type:"primary","html-type":"submit"},{default:c(()=>[A(B(i.isEditMode?"Update News":"Create News"),1)]),_:1}),u(S,{as:"link",href:e.route("admin.articles.index")},{default:c(()=>t[10]||(t[10]=[A(" Cancel ")])),_:1},8,["href"])]),_:1})]),_:1})]),_:1},8,["model","onFinish"])]),_:1})])])]),_:1})}const Ve=ne(be,[["render",Ae],["__scopeId","data-v-f25c59a9"]]);export{Ve as default};
